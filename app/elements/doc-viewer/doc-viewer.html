<link rel="import" href="../../bower_components/marked-element/marked-element.html">
<link rel="import" href="../../bower_components/prism-highlighter/prism-highlighter.html">
<link rel="import" href="../../bower_components/hydrolysis/hydrolysis-analyzer.html">

<dom-module id="doc-viewer">
  <style>
    marked-element::shadow p {
      line-height: 20px;
    }

    marked-element::shadow p:first-child { margin-top: 0; }
    marked-element::shadow p:last-child { margin-bottom: 0; }
  </style>
  <template>
    <hydrolysis-analyzer id="analyzer" analyzer="{{_analyzer}}" clean></hydrolysis-analyzer>

    <prism-highlighter></prism-highlighter>
    <marked-element markdown="[[_element.desc]]"></marked-element>

    <template is="x-repeat" items="[[_element.properties]]">
      <h4 class="paper-font-title">[[item.name]]</h4>
      <marked-element markdown="[[item.desc]]"></marked-element>
    </template>
  </template>
</dom-module>

<script>
(function() {
  Polymer({
    is: 'doc-viewer',
    properties: {
      _analyzer: Object,
      data: Object,
      element: String,
      _element: {type: Object, notify: true}
    },
    observers: {
      element: '_analyze',
      _analyzer: 'loadData'
    },
    loadData: function() {
      if (this._analyzer) {
        this._element = this._analyzer.elementsByTagName[this.element];
      } else {
        this._element = null;
      }
    },
    _analyze: function() {
      this.$.analyzer.src = ["/bower_components", this.element, this.element + ".html"].join("/");
      this.$.analyzer.analyze();
    }
  });
})();
</script>