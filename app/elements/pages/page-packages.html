<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-icons/maps-icons.html">

<link rel="import" href="../catalog-data/catalog-data.html">
<link rel="import" href="../package-tile/package-tile.html">

<dom-module id="page-packages">
  <style>
    paper-header-panel::shadow #mainContainer {
      background: #eee;
    }

    .content {
      display: block;
      padding: 16px;
    }

    .packages {
      max-width: 1100px;
      margin: 0 auto;
    }

    @media (max-width: 1132px) {
      .packages {
        max-width: 880px;
      }
    }

    @media (max-width: 912px) {
      .packages {
        max-width: 660px;
      }
    }

    @media (max-width: 692px) {
      .packages {
        max-width: 440px;
      }
    }

    package-tile {
      width: 220px;
    }

    @media (max-width: 489px) {
      package-tile {
        width: 100%;
      }
    }

    .search.active {
      left: 15px;
    }

    @media (max-width: 639px) {
      paper-toolbar /deep/ #topBar {
        margin-top: 4px;
        padding: 0 16px;
      }
    }
  </style>
  <template>
    <catalog-data packages="{{packages}}"></catalog-data>
    <paper-header-panel class="fit">
      <paper-toolbar class="paper-header medium-tall">
        <app-logo full class="flex"></app-logo>
        <nav class="flex bottom">
          <a class="active" href="/" is="pushstate-anchor">Elements</a>
          <a href="/guides" is="pushstate-anchor">Guides</a>
        </nav>
        <app-bar class="horizontal layout center end-justified" query="{{q}}"></app-bar>
      </paper-toolbar>

      <div class="content fit">
        <div class="packages layout horizontal wrap">
          <template is="x-repeat" items="[[packages]]">
            <package-tile class="flex-none" name$="[[item.name]]" on-click="select"></package-tile>
          </template>
        </div>
      </div>
    </paper-header-panel>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'page-packages',
    properties: {
      q: { type: String, notify: true }
    },
    attached: function() {
      // reset page title since this is the default page
      this.fire('page-meta', {title: null});
    },
    observers: {
      q: 'search'
    },
    search: function() {
      if (this.q) {
        this.router.go('/browse?q=' + this.q);
      }
    },
    select: function(e) {
      this.router.go('/browse?package=' + e.currentTarget.getAttribute('name'));
    }
  });
</script>