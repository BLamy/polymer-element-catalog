<link rel="import" href="../catalog-data/catalog-data.html">
<link rel="import" href="../package-tile/package-tile.html">

<dom-module id="page-packages">
  <style>
    .content {
      display: block;
      background: #eee;
      padding: 16px;
    }

    core-toolbar {
      background: white;
      color: #333;
      transition: height 450ms cubic-bezier(0.55, 0, 0.1, 1);
    }

    core-toolbar a {
      text-decoration: none;
      color: white;
      display: inline-block;
      padding: 0 8px;
      margin: 0 4px;
    }

    .logo img {
      margin: 0 12px 0 0;
    }

    .search {
      position: relative;
    }

    .search core-icon {
      position: absolute;
      top: 8px;
      left: 8px;
      z-index: 2;
      cursor: pointer;
    }

    .search input {
      font-family: RobotoDraft, Helvetica, Arial, sans-serif;
      font-size: 15px;
      width: 0;
      padding: 10px 10px 10px 30px;
      border: 1px solid #ccc;
      border-radius: 2px;
      opacity: 0;
      -webkit-appearance: none;
      visibility: hidden;
      transition: all 450ms cubic-bezier(0.55, 0, 0.1, 1);
    }

    .search.active input {
      width: 300px;
      opacity: 1;
      visibility: visible;
    }

    .search input:focus {
      outline: 0;
    }
  </style>
  <template>
    <catalog-data packages="{{packages}}"></catalog-data>
    <core-header-panel class="fit">
      <core-toolbar>
        <div class="logo horizontal layout center flex"><img src="/images/polymer.svg" width="40"> Catalog</div>
        <div class="search">  
          <core-icon icon="search" on-click="toggleSearch"></core-icon>
          <form on-submit="performSearch"><input id="query" type="search" value="{{query::keyup}}"></form>
        </div>
      </core-toolbar>

      <div class="content fit">
        <responsive-element class="horizontal layout wrap">
          <template is="x-repeat" items="[[packages]]">
            <package-tile class="flex" name$="[[item.name]]" on-click="select"></package-tile>
          </template>
        </responsive-element>
      </div>
    </core-header-panel>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'page-packages',
    select: function(e) {
      this.router.go('/browse?package=' + e.currentTarget.getAttribute('name'));
    },
    toggleSearch: function(e) {
      e.target.parentNode.classList.toggle('active');
    },
    performSearch: function(e) {
      e.preventDefault();
      this.router.go('/browse?q=' + this.query);
    }
  });
</script>